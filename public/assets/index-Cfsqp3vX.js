var F=Object.defineProperty;var B=(n,s,t)=>s in n?F(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var P=(n,s,t)=>B(n,typeof s!="symbol"?s+"":s,t);import{r as I,j as e,c as w,B as C,t as a,u as O}from"./index-D-v0RGVJ.js";import{L as S}from"./layout-CYYwhQ1p.js";import{T as U}from"./theme-switch-CRZ_HEbF.js";import{H}from"./header-unrestricted-pages-BjhRmTEg.js";import{C as v}from"./card-WwUaA1hq.js";import{u as y,t as V,F as D,a as c,b as m,c as u,d as f,e as p}from"./form-Dmwd8xM6.js";import{z as l}from"./index-DXqQCM1T.js";import{I as g}from"./input-q4i4jPww.js";import{P as L,a as M}from"./pin-input-Byh9z5LE.js";import{S as k}from"./separator-DnarkMef.js";import{P as T}from"./password-input-gxYof4Yh.js";import{r as j,d as x,u as R,g as z,c as N,p as G,o as K,a as Z,b as Y}from"./firebase-Bu969cej.js";import"./index-BUcss_Cc.js";import"./index-Bj-gm62b.js";import"./Combination-CKjHqv8T.js";import"./index-BOJt0QhU.js";import"./tslib.es6-CDuPK5Eb.js";var $={VITE_PRODUCT_NAME:"Zen",VITE_PRODUCT_TAGLINE:"Relax and Rejuvenate",VITE_PRODUCT_SUMMARY:"Zen - Automated Hotel Services",VITE_PRODUCT_LANDSCAPE_IMAGE_FOR_SOCIALS:"https://shadcn-admin.netlify.app/images/shadcn-admin.png",VITE_FAVICON:"https://zen-resort.web.app/assets/favicon.ico",VITE_PROD_DOMAIN:"https://zen-resort.web.app",VITE_FIREBASE_API_KEY:"AIzaSyAIKDhzuabGUaO52qtnQokEIpAh-Yt_TSo",VITE_FIREBASE_AUTH_DOMAIN:"zen-resort.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://zen-resort-default-rtdb.asia-southeast1.firebasedatabase.app",VITE_FIREBASE_PROJECT_ID:"zen-resort",VITE_FIREBASE_STORAGE_BUCKET:"zen-resort.appspot.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"47411896955",VITE_FIREBASE_APP_ID:"1:47411896955:web:36da7bf642d25bb80138de",VITE_FIREBASE_MEASUREMENT_ID:"G-X1Z3YRMMZ0",VITE_MIXPANEL_KEY:"3f85b37beb6296bd7ecd350f939c543a",VITE_PROD_CLOUD_SERVER_URL:"https://edtch.pw/",VITE_LOCAL_BACKEND_MOCK_SERVER_URL:"http://localhost:8383/",VITE_CRISP_WEBSITE_ID:"3f85b37beb6296bd7ecd350f939c543a",VITE_ADMIN_CODE:"212121"};const W=l.object({otp:l.string().min(1,{message:"Please enter your code."})});function X({className:n,verify_pin_callback:s,...t}){const[o,b]=I.useState(!1),[i,E]=I.useState(!0),r=y({resolver:V(W),defaultValues:{otp:""}});function h(d){d.otp===$.VITE_ADMIN_CODE?(r.reset(),b(!1),s(!0)):(r.setError("otp",{type:"manual",message:"Invalid code"}),b(!1))}return e.jsx("div",{className:w("grid gap-6",n),...t,children:e.jsx(D,{...r,children:e.jsx("form",{onSubmit:r.handleSubmit(h),children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{control:r.control,name:"otp",render:({field:d})=>e.jsxs(m,{className:"space-y-1",children:[e.jsx(u,{children:e.jsx(L,{...d,className:"flex h-10 justify-between",onComplete:()=>E(!1),onIncomplete:()=>E(!0),children:Array.from({length:7},(A,_)=>_===3?e.jsx(k,{orientation:"vertical"},_):e.jsx(M,{component:g,className:`${r.getFieldState("otp").invalid?"border-red-500":""}`},_))})}),e.jsx(f,{})]})}),e.jsx(C,{className:"mt-2",disabled:i,loading:o,children:"Verify"})]})})})})}class q{constructor(){P(this,"isReadAllowed");P(this,"isChangeAllowed");this.isReadAllowed=!0,this.isChangeAllowed=!0}async update(s){if(!this.isChangeAllowed)return a({title:"Updates have been blocked for this account, due to suspicious traffic"}),Promise.reject("Updates are blocked for this account");for(const t in s)if(t===void 0||String(t).includes("/undefined"))return a({title:"One of the addresses in the update object is undefined"}),Promise.reject("Invalid address in updates object");try{const t=j(x);return await R(t,s),Promise.resolve("Update successful")}catch(t){return console.error("Error updating database:",t),a({title:"Failed to update database"}),Promise.reject(t)}}async read(s){if(!this.isReadAllowed)return a({title:"Reads have been blocked for this account, due to suspicious traffic"}),Promise.reject("Reads have been blocked for this account, due to suspicious traffic");if(s===void 0)return a({title:"The address for read object is undefined"}),Promise.reject("The address for read object is undefined");if(String(s).includes("/undefined"))return a({title:"The address for read object is undefined"}),Promise.reject("The address for read object is undefined");if(s==="Hotel-Admins"||s==="/Hotel-Admins"||s==="Hotel-Admins/"||s==="/Hotel-Admins/")return a({title:"Cannot read from root Hotel-Admins address"}),Promise.reject("Cannot read from root Hotel-Admins address");const t=j(x);return(await z(N(t,s))).val()}async delete(s){if(!this.isChangeAllowed)return a({title:"Updates have been blocked for this account, due to suspicious traffic"}),Promise.reject("Updates are blocked for this account");for(const t of s){if(t===void 0||String(t).includes("/undefined"))return a({title:"One of the addresses in the update object is undefined"}),Promise.reject("Invalid address in updates object");if(t.split("/").length===1)return a({title:"Cannot delete from root address"}),Promise.reject("Cannot delete from root address")}try{const t=j(x);return await R(t,s.map(o=>({[o]:null}))),Promise.resolve("Delete successful")}catch(t){return console.error("Error deleting database location:",t),a({title:"Failed to delete database location"}),Promise.reject(t)}}getPushKey(s){return G(N(j(x),s)).key}async listen(s,t){if(s===void 0)return a({title:"The address for listen object is undefined"}),Promise.reject("The address for listen object is undefined");if(String(s).includes("/undefined"))return a({title:"The address for listen object is undefined"}),Promise.reject("The address for listen object is undefined");if(s==="Hotel-Admins"||s==="/Hotel-Admins"||s==="Hotel-Admins/"||s==="/Hotel-Admins/")return a({title:"Cannot listen from root Hotel-Admins address"}),Promise.reject("Cannot listen from root Hotel-Admins address");const o=j(x);K(N(o,s),t)}}const J=new q,Q=l.object({name:l.string().min(1,{message:"Please enter business name"}),email:l.string().min(1,{message:"Please enter email"}).email({message:"Invalid email address"}),phone:l.string().min(1,{message:"Please enter phone number"}),password:l.string().min(1,{message:"Please enter password"}).min(7,{message:"Password must be at least 7 characters long"}),confirmPassword:l.string()}).refine(n=>n.password===n.confirmPassword,{message:"Passwords don't match.",path:["confirmPassword"]});function be(){const[n,s]=I.useState(!1),[t,o]=I.useState(!1),b=O(),i=y({resolver:V(Q),defaultValues:{email:"",password:"",confirmPassword:""}});function E(r){o(!0),console.log(r),Z(Y,r.email,r.password).then(h=>{const d=h.user;console.log("User created:",d);const A={};A[`ZEN-Business-Accounts/${d.uid}/SelfInfo`]={name:r.name,email:r.email,phone:r.phone,role:"hotel-admin"},J.update(A),o(!1),a({title:"New Business Account created successfully!"}),b("/sign-in")}).catch(h=>{const d=h.message;a({title:d}),o(!1)})}return e.jsxs(S,{children:[e.jsxs(S.Header,{children:[e.jsx(H,{activeRoute:"/zen-business-admins"}),e.jsx("div",{className:"ml-auto flex items-center space-x-4",children:e.jsx(U,{})})]}),e.jsx(S.Body,{children:n===!1?e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex items-center justify-center",style:{height:"80vh"},children:e.jsx("div",{children:e.jsxs(v,{className:"p-6",children:[e.jsxs("div",{className:"mb-2 flex flex-col space-y-2 text-left",children:[e.jsx("h1",{className:"text-md font-semibold tracking-tight",children:"Zen Business Admin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please enter the special code to access this area."})]}),e.jsx(X,{verify_pin_callback:s})]})})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex items-center justify-center",style:{height:"80vh"},children:e.jsxs(v,{className:"p-6",style:{width:"35%"},children:[e.jsxs("div",{className:"mb-2 flex flex-col space-y-2 text-left",children:[e.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"Create Business Account"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Enter email and password to create an account. ",e.jsx("br",{})]})]}),e.jsx("div",{className:w("grid gap-6"),children:e.jsx(D,{...i,children:e.jsx("form",{onSubmit:i.handleSubmit(E),children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{control:i.control,name:"name",render:({field:r})=>e.jsxs(m,{className:"space-y-1",children:[e.jsx(p,{children:"Business Name"}),e.jsx(u,{children:e.jsx(g,{placeholder:"e.g Izakaya",...r})}),e.jsx(f,{})]})}),e.jsx(c,{control:i.control,name:"email",render:({field:r})=>e.jsxs(m,{className:"space-y-1",children:[e.jsx(p,{children:"Business Email"}),e.jsx(u,{children:e.jsx(g,{placeholder:"name@example.com",...r})}),e.jsx(f,{})]})}),e.jsx(c,{control:i.control,name:"phone",render:({field:r})=>e.jsxs(m,{className:"space-y-1",children:[e.jsx(p,{children:"Business Phone"}),e.jsx(u,{children:e.jsx(g,{placeholder:"e.g 01700766173",...r})}),e.jsx(f,{})]})}),e.jsx(c,{control:i.control,name:"password",render:({field:r})=>e.jsxs(m,{className:"space-y-1",children:[e.jsx(p,{children:"Password"}),e.jsx(u,{children:e.jsx(T,{placeholder:"********",...r})}),e.jsx(f,{})]})}),e.jsx(c,{control:i.control,name:"confirmPassword",render:({field:r})=>e.jsxs(m,{className:"space-y-1",children:[e.jsx(p,{children:"Confirm Password"}),e.jsx(u,{children:e.jsx(T,{placeholder:"********",...r})}),e.jsx(f,{})]})}),e.jsx(C,{className:"mt-2",loading:t,children:"Create Account"}),e.jsx("div",{className:"relative my-2",children:e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})})})]})})})})]})})})})]})}export{be as default};
